<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <title>Consuming
</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta name="description" content="F# client for Kafka"/>
    <meta name="author" content="Jet.com"/>

    <script src="https://code.jquery.com/jquery-1.8.0.js"></script>
    <script src="https://code.jquery.com/ui/1.8.23/jquery-ui.js"></script>
    <script src="https://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/js/bootstrap.min.js"></script>
    <link href="https://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/css/bootstrap-combined.min.css" rel="stylesheet"/>

    <link type="text/css" rel="stylesheet" href="/kafunk/content/style.css" />
    <script type="text/javascript" src="/kafunk/content/tips.js"></script>
    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="container">
      <div class="masthead">
        <ul class="nav nav-pills pull-right">
          <li><a href="http://fsharp.org">fsharp.org</a></li>
          <li><a href="http://github.com/jet/kafunk">github page</a></li>
        </ul>
        <h3 class="muted"><a href="/kafunk/index.html">Kafunk</a></h3>
      </div>
      <hr />
      <div class="row">
        <div class="span9" id="main">
          
<h1><a name="Consuming" class="anchor" href="#Consuming">Consuming</a></h1>
<p>This example demonstrates how to consume using Kafunk.</p>
<p>Joining the consumer group:
See also: (ConsumerConfig)[<a href="https://jet.github.io/kafunk/reference/kafunk-consumerconfig.html">https://jet.github.io/kafunk/reference/kafunk-consumerconfig.html</a>]</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
<span class="l">17: </span>
<span class="l">18: </span>
<span class="l">19: </span>
<span class="l">20: </span>
<span class="l">21: </span>
<span class="l">22: </span>
<span class="l">23: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="prep">#r</span> <span class="s">&quot;kafunk.dll&quot;</span>
<span class="prep">#r</span> <span class="s">&quot;FSharp.Control.AsyncSeq.dll&quot;</span>

<span class="k">open</span> <span onmouseout="hideTip(event, 'fs1', 1)" onmouseover="showTip(event, 'fs1', 1)" class="i">FSharp</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs2', 2)" onmouseover="showTip(event, 'fs2', 2)" class="i">Control</span>
<span class="k">open</span> <span onmouseout="hideTip(event, 'fs3', 3)" onmouseover="showTip(event, 'fs3', 3)" class="i">Kafunk</span>
<span class="k">open</span> <span onmouseout="hideTip(event, 'fs4', 4)" onmouseover="showTip(event, 'fs4', 4)" class="i">System</span>

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs5', 5)" onmouseover="showTip(event, 'fs5', 5)" class="i">conn</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs6', 6)" onmouseover="showTip(event, 'fs6', 6)" class="t">Kafka</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs7', 7)" onmouseover="showTip(event, 'fs7', 7)" class="f">connHost</span> <span class="s">&quot;existential-host&quot;</span>

<span class="c">/// Configuration.</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs8', 8)" onmouseover="showTip(event, 'fs8', 8)" class="i">consumerConfig</span> <span class="o">=</span> 
  <span onmouseout="hideTip(event, 'fs9', 9)" onmouseover="showTip(event, 'fs9', 9)" class="t">ConsumerConfig</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs10', 10)" onmouseover="showTip(event, 'fs10', 10)" class="f">create</span> (

    <span class="c">/// The name of the consumer group.</span>
    <span class="i">groupId</span> <span class="o">=</span> <span class="s">&quot;consumer-group&quot;</span>, 

    <span class="c">/// The topic to consume.</span>
    <span class="i">topic</span> <span class="o">=</span> <span class="s">&quot;absurd-topic&quot;</span>)


<span class="c">/// This creates a consumer and joins it to the group.</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs11', 11)" onmouseover="showTip(event, 'fs11', 11)" class="i">consumer</span> <span class="o">=</span>
  <span onmouseout="hideTip(event, 'fs12', 12)" onmouseover="showTip(event, 'fs12', 12)" class="t">Consumer</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs13', 13)" onmouseover="showTip(event, 'fs13', 13)" class="f">create</span> <span onmouseout="hideTip(event, 'fs5', 14)" onmouseover="showTip(event, 'fs5', 14)" class="i">conn</span> <span onmouseout="hideTip(event, 'fs8', 15)" onmouseover="showTip(event, 'fs8', 15)" class="i">consumerConfig</span>
</code></pre></td>
</tr>
</table>
<h2><a name="Consumer-State" class="anchor" href="#Consumer-State">Consumer State</a></h2>
<p>Consumer state consists of consumer group member state, as well as state particular to the consumer group protocol, such
as the set of partitions assigned to the consumer. The state can be retrieved, but note that state changes when group
membership changes.</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
<span class="l">6: </span>
<span class="l">7: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs14', 16)" onmouseover="showTip(event, 'fs14', 16)" class="i">consumerState</span> <span class="o">=</span> 
  <span onmouseout="hideTip(event, 'fs12', 17)" onmouseover="showTip(event, 'fs12', 17)" class="t">Consumer</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs15', 18)" onmouseover="showTip(event, 'fs15', 18)" class="f">state</span> <span onmouseout="hideTip(event, 'fs11', 19)" onmouseover="showTip(event, 'fs11', 19)" class="i">consumer</span>
  <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs16', 20)" onmouseover="showTip(event, 'fs16', 20)" class="t">Async</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs17', 21)" onmouseover="showTip(event, 'fs17', 21)" class="f">RunSynchronously</span>

<span onmouseout="hideTip(event, 'fs18', 22)" onmouseover="showTip(event, 'fs18', 22)" class="f">printfn</span> <span class="s">&quot;generation_id=</span><span class="pf">%i</span><span class="s"> member_id=</span><span class="pf">%s</span><span class="s"> leader_id=</span><span class="pf">%s</span><span class="s"> assignment_stratgey=</span><span class="pf">%s</span><span class="s"> partitions=</span><span class="pf">%A</span><span class="s">&quot;</span> 
  <span onmouseout="hideTip(event, 'fs14', 23)" onmouseover="showTip(event, 'fs14', 23)" class="i">consumerState</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs19', 24)" onmouseover="showTip(event, 'fs19', 24)" class="i">generationId</span> <span onmouseout="hideTip(event, 'fs14', 25)" onmouseover="showTip(event, 'fs14', 25)" class="i">consumerState</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs20', 26)" onmouseover="showTip(event, 'fs20', 26)" class="i">memberId</span> <span onmouseout="hideTip(event, 'fs14', 27)" onmouseover="showTip(event, 'fs14', 27)" class="i">consumerState</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs21', 28)" onmouseover="showTip(event, 'fs21', 28)" class="i">leaderId</span> 
  <span onmouseout="hideTip(event, 'fs14', 29)" onmouseover="showTip(event, 'fs14', 29)" class="i">consumerState</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs22', 30)" onmouseover="showTip(event, 'fs22', 30)" class="i">assignmentStrategy</span> <span onmouseout="hideTip(event, 'fs14', 31)" onmouseover="showTip(event, 'fs14', 31)" class="i">consumerState</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs23', 32)" onmouseover="showTip(event, 'fs23', 32)" class="i">assignments</span> 
</code></pre></td>
</tr>
</table>
<h2><a name="Consuming-1" class="anchor" href="#Consuming-1">Consuming</a></h2>
<p>Consume with commit on every message set. In this case, offsets are committed as soon as
a message set is processed. Note that this may result in needless synchronization - since the
strongest delivery model supported is at-least-once, consumers have to be tolerant to
receiving duplicate messages. Therefore, it is acceptable to commit offsets asynchronously.</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
<span class="l">6: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span onmouseout="hideTip(event, 'fs12', 33)" onmouseover="showTip(event, 'fs12', 33)" class="t">Consumer</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs24', 34)" onmouseover="showTip(event, 'fs24', 34)" class="f">consume</span> <span onmouseout="hideTip(event, 'fs11', 35)" onmouseover="showTip(event, 'fs11', 35)" class="i">consumer</span> 
  (<span class="k">fun</span> (<span onmouseout="hideTip(event, 'fs25', 36)" onmouseover="showTip(event, 'fs25', 36)" class="i">s</span><span class="o">:</span><span onmouseout="hideTip(event, 'fs26', 37)" onmouseover="showTip(event, 'fs26', 37)" class="t">GroupMemberState</span>) (<span onmouseout="hideTip(event, 'fs27', 38)" onmouseover="showTip(event, 'fs27', 38)" class="i">ms</span><span class="o">:</span><span onmouseout="hideTip(event, 'fs28', 39)" onmouseover="showTip(event, 'fs28', 39)" class="t">ConsumerMessageSet</span>) <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs29', 40)" onmouseover="showTip(event, 'fs29', 40)" class="i">async</span> {
    <span onmouseout="hideTip(event, 'fs18', 41)" onmouseover="showTip(event, 'fs18', 41)" class="f">printfn</span> <span class="s">&quot;member_id=</span><span class="pf">%s</span><span class="s"> assignment_strategy=</span><span class="pf">%s</span><span class="s"> topic=</span><span class="pf">%s</span><span class="s"> partition=</span><span class="pf">%i</span><span class="s">&quot;</span> 
      <span onmouseout="hideTip(event, 'fs25', 42)" onmouseover="showTip(event, 'fs25', 42)" class="i">s</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs30', 43)" onmouseover="showTip(event, 'fs30', 43)" class="i">memberId</span> <span onmouseout="hideTip(event, 'fs25', 44)" onmouseover="showTip(event, 'fs25', 44)" class="i">s</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs31', 45)" onmouseover="showTip(event, 'fs31', 45)" class="i">protocolName</span> <span onmouseout="hideTip(event, 'fs27', 46)" onmouseover="showTip(event, 'fs27', 46)" class="i">ms</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs32', 47)" onmouseover="showTip(event, 'fs32', 47)" class="i">topic</span> <span onmouseout="hideTip(event, 'fs27', 48)" onmouseover="showTip(event, 'fs27', 48)" class="i">ms</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs33', 49)" onmouseover="showTip(event, 'fs33', 49)" class="i">partition</span>
    <span class="k">do!</span> <span onmouseout="hideTip(event, 'fs12', 50)" onmouseover="showTip(event, 'fs12', 50)" class="t">Consumer</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs34', 51)" onmouseover="showTip(event, 'fs34', 51)" class="f">commitOffsets</span> <span onmouseout="hideTip(event, 'fs11', 52)" onmouseover="showTip(event, 'fs11', 52)" class="i">consumer</span> (<span onmouseout="hideTip(event, 'fs28', 53)" onmouseover="showTip(event, 'fs28', 53)" class="t">ConsumerMessageSet</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs35', 54)" onmouseover="showTip(event, 'fs35', 54)" class="f">commitPartitionOffsets</span> <span onmouseout="hideTip(event, 'fs27', 55)" onmouseover="showTip(event, 'fs27', 55)" class="i">ms</span>) })
<span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs16', 56)" onmouseover="showTip(event, 'fs16', 56)" class="t">Async</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs17', 57)" onmouseover="showTip(event, 'fs17', 57)" class="f">RunSynchronously</span>
</code></pre></td>
</tr>
</table>
<p>Consume with periodic commit. This commits offsets asynchronously thereby eliminating a synchronization in
the critical path.</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
<span class="l">6: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span onmouseout="hideTip(event, 'fs12', 58)" onmouseover="showTip(event, 'fs12', 58)" class="t">Consumer</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs36', 59)" onmouseover="showTip(event, 'fs36', 59)" class="f">consumePeriodicCommit</span> <span onmouseout="hideTip(event, 'fs11', 60)" onmouseover="showTip(event, 'fs11', 60)" class="i">consumer</span>
  (<span onmouseout="hideTip(event, 'fs37', 61)" onmouseover="showTip(event, 'fs37', 61)" class="t">TimeSpan</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs38', 62)" onmouseover="showTip(event, 'fs38', 62)" class="f">FromSeconds</span> <span class="n">10.0</span>) 
  (<span class="k">fun</span> (<span onmouseout="hideTip(event, 'fs25', 63)" onmouseover="showTip(event, 'fs25', 63)" class="i">s</span><span class="o">:</span><span onmouseout="hideTip(event, 'fs26', 64)" onmouseover="showTip(event, 'fs26', 64)" class="t">GroupMemberState</span>) (<span onmouseout="hideTip(event, 'fs27', 65)" onmouseover="showTip(event, 'fs27', 65)" class="i">ms</span><span class="o">:</span><span onmouseout="hideTip(event, 'fs28', 66)" onmouseover="showTip(event, 'fs28', 66)" class="t">ConsumerMessageSet</span>) <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs29', 67)" onmouseover="showTip(event, 'fs29', 67)" class="i">async</span> {
    <span onmouseout="hideTip(event, 'fs18', 68)" onmouseover="showTip(event, 'fs18', 68)" class="f">printfn</span> <span class="s">&quot;member_id=</span><span class="pf">%s</span><span class="s"> assignment_strategy=</span><span class="pf">%s</span><span class="s"> topic=</span><span class="pf">%s</span><span class="s"> partition=</span><span class="pf">%i</span><span class="s">&quot;</span> 
      <span onmouseout="hideTip(event, 'fs25', 69)" onmouseover="showTip(event, 'fs25', 69)" class="i">s</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs30', 70)" onmouseover="showTip(event, 'fs30', 70)" class="i">memberId</span> <span onmouseout="hideTip(event, 'fs25', 71)" onmouseover="showTip(event, 'fs25', 71)" class="i">s</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs31', 72)" onmouseover="showTip(event, 'fs31', 72)" class="i">protocolName</span> <span onmouseout="hideTip(event, 'fs27', 73)" onmouseover="showTip(event, 'fs27', 73)" class="i">ms</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs32', 74)" onmouseover="showTip(event, 'fs32', 74)" class="i">topic</span> <span onmouseout="hideTip(event, 'fs27', 75)" onmouseover="showTip(event, 'fs27', 75)" class="i">ms</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs33', 76)" onmouseover="showTip(event, 'fs33', 76)" class="i">partition</span> })
<span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs16', 77)" onmouseover="showTip(event, 'fs16', 77)" class="t">Async</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs17', 78)" onmouseover="showTip(event, 'fs17', 78)" class="f">RunSynchronously</span>
</code></pre></td>
</tr>
</table>
<h2><a name="Periodic-Offset-Commit" class="anchor" href="#Periodic-Offset-Commit">Periodic Offset Commit</a></h2>
<p><code>Consumer.consumePeriodicCommit</code> commits offsets periodically using the following mechanism.</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
<span class="l">6: </span>
<span class="l">7: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="c">/// Create a commit queue</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs39', 79)" onmouseover="showTip(event, 'fs39', 79)" class="i">commitQueue</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs40', 80)" onmouseover="showTip(event, 'fs40', 80)" class="t">Offsets</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs41', 81)" onmouseover="showTip(event, 'fs41', 81)" class="f">createPeriodicCommitQueue</span> (<span onmouseout="hideTip(event, 'fs37', 82)" onmouseover="showTip(event, 'fs37', 82)" class="t">TimeSpan</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs42', 83)" onmouseover="showTip(event, 'fs42', 83)" class="f">FromHours</span> <span class="n">1.0</span>, <span onmouseout="hideTip(event, 'fs12', 84)" onmouseover="showTip(event, 'fs12', 84)" class="t">Consumer</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs34', 85)" onmouseover="showTip(event, 'fs34', 85)" class="f">commitOffsets</span> <span onmouseout="hideTip(event, 'fs11', 86)" onmouseover="showTip(event, 'fs11', 86)" class="i">consumer</span>)

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs43', 87)" onmouseover="showTip(event, 'fs43', 87)" class="i">ms</span> <span class="o">:</span> <span onmouseout="hideTip(event, 'fs28', 88)" onmouseover="showTip(event, 'fs28', 88)" class="t">ConsumerMessageSet</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs44', 89)" onmouseover="showTip(event, 'fs44', 89)" class="f">failwith</span> <span class="s">&quot;some message set&quot;</span>

<span class="c">/// Asynchronously enqueue offsets to be committed.</span>
<span onmouseout="hideTip(event, 'fs40', 90)" onmouseover="showTip(event, 'fs40', 90)" class="t">Offsets</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs45', 91)" onmouseover="showTip(event, 'fs45', 91)" class="f">enqueuePeriodicCommit</span> <span onmouseout="hideTip(event, 'fs39', 92)" onmouseover="showTip(event, 'fs39', 92)" class="i">commitQueue</span> (<span onmouseout="hideTip(event, 'fs28', 93)" onmouseover="showTip(event, 'fs28', 93)" class="t">ConsumerMessageSet</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs35', 94)" onmouseover="showTip(event, 'fs35', 94)" class="f">commitPartitionOffsets</span> <span onmouseout="hideTip(event, 'fs43', 95)" onmouseover="showTip(event, 'fs43', 95)" class="i">ms</span>)
</code></pre></td>
</tr>
</table>
<p>The commit queue will commit enqueued offsets periodically. It will commit the greatest offset enqueued by partition.</p>
<h2><a name="Streaming" class="anchor" href="#Streaming">Streaming</a></h2>
<p>In order to have explicit control of buffering and parallelism, or to perform other streaming operations, it is possible
to consume messages directly using an asynchronous sequence:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span onmouseout="hideTip(event, 'fs12', 96)" onmouseover="showTip(event, 'fs12', 96)" class="t">Consumer</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs46', 97)" onmouseover="showTip(event, 'fs46', 97)" class="f">stream</span> <span onmouseout="hideTip(event, 'fs11', 98)" onmouseover="showTip(event, 'fs11', 98)" class="i">consumer</span>
<span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs47', 99)" onmouseover="showTip(event, 'fs47', 99)" class="t">AsyncSeq</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs48', 100)" onmouseover="showTip(event, 'fs48', 100)" class="f">iterAsync</span> (<span class="k">fun</span> (<span onmouseout="hideTip(event, 'fs25', 101)" onmouseover="showTip(event, 'fs25', 101)" class="i">s</span>,<span onmouseout="hideTip(event, 'fs27', 102)" onmouseover="showTip(event, 'fs27', 102)" class="i">ms</span>) <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs29', 103)" onmouseover="showTip(event, 'fs29', 103)" class="i">async</span> {
  <span onmouseout="hideTip(event, 'fs18', 104)" onmouseover="showTip(event, 'fs18', 104)" class="f">printfn</span> <span class="s">&quot;member_id=</span><span class="pf">%s</span><span class="s"> assignment_strategy=</span><span class="pf">%s</span><span class="s"> topic=</span><span class="pf">%s</span><span class="s"> partition=</span><span class="pf">%i</span><span class="s">&quot;</span> 
    <span onmouseout="hideTip(event, 'fs25', 105)" onmouseover="showTip(event, 'fs25', 105)" class="i">s</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs30', 106)" onmouseover="showTip(event, 'fs30', 106)" class="i">memberId</span> <span onmouseout="hideTip(event, 'fs25', 107)" onmouseover="showTip(event, 'fs25', 107)" class="i">s</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs31', 108)" onmouseover="showTip(event, 'fs31', 108)" class="i">protocolName</span> <span onmouseout="hideTip(event, 'fs27', 109)" onmouseover="showTip(event, 'fs27', 109)" class="i">ms</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs32', 110)" onmouseover="showTip(event, 'fs32', 110)" class="i">topic</span> <span onmouseout="hideTip(event, 'fs27', 111)" onmouseover="showTip(event, 'fs27', 111)" class="i">ms</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs33', 112)" onmouseover="showTip(event, 'fs33', 112)" class="i">partition</span> })
</code></pre></td>
</tr>
</table>
<p>The resulting stream merges all of the per-broker streams covering all assigned partitions of the consumed topic. Note that offsets
must be committed explicitly.</p>
<h2><a name="Consumer-Offsets" class="anchor" href="#Consumer-Offsets">Consumer Offsets</a></h2>
<p>Consumer offsets can be committed explicitly. This can be used to reset a consumer to a particular offset when
the consumer instances are offline. Note that consumer instances only fetch committed offsets when they are starting
to consumer, or when rejoining.</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
<span class="l">6: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span onmouseout="hideTip(event, 'fs12', 113)" onmouseover="showTip(event, 'fs12', 113)" class="t">Consumer</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs34', 114)" onmouseover="showTip(event, 'fs34', 114)" class="f">commitOffsets</span> <span onmouseout="hideTip(event, 'fs11', 115)" onmouseover="showTip(event, 'fs11', 115)" class="i">consumer</span> [| <span class="n">0</span>, <span class="n">1L</span> |]
<span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs16', 116)" onmouseover="showTip(event, 'fs16', 116)" class="t">Async</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs17', 117)" onmouseover="showTip(event, 'fs17', 117)" class="f">RunSynchronously</span>


<span onmouseout="hideTip(event, 'fs12', 118)" onmouseover="showTip(event, 'fs12', 118)" class="t">Consumer</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs49', 119)" onmouseover="showTip(event, 'fs49', 119)" class="f">commitOffsetsToTime</span> <span onmouseout="hideTip(event, 'fs11', 120)" onmouseover="showTip(event, 'fs11', 120)" class="i">consumer</span> <span onmouseout="hideTip(event, 'fs50', 121)" onmouseover="showTip(event, 'fs50', 121)" class="t">Time</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs51', 122)" onmouseover="showTip(event, 'fs51', 122)" class="i">EarliestOffset</span>
<span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs16', 123)" onmouseover="showTip(event, 'fs16', 123)" class="t">Async</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs17', 124)" onmouseover="showTip(event, 'fs17', 124)" class="f">RunSynchronously</span>
</code></pre></td>
</tr>
</table>
<p>Fetch committed consumer offsets:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
<span class="l">6: </span>
<span class="l">7: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs52', 125)" onmouseover="showTip(event, 'fs52', 125)" class="i">consumerOffsets</span> <span class="o">=</span>
  <span onmouseout="hideTip(event, 'fs12', 126)" onmouseover="showTip(event, 'fs12', 126)" class="t">Consumer</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs53', 127)" onmouseover="showTip(event, 'fs53', 127)" class="f">fetchOffsets</span> <span onmouseout="hideTip(event, 'fs5', 128)" onmouseover="showTip(event, 'fs5', 128)" class="i">conn</span> <span class="s">&quot;consumer-group&quot;</span> [||]
  <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs16', 129)" onmouseover="showTip(event, 'fs16', 129)" class="t">Async</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs17', 130)" onmouseover="showTip(event, 'fs17', 130)" class="f">RunSynchronously</span>

<span class="k">for</span> (<span onmouseout="hideTip(event, 'fs54', 131)" onmouseover="showTip(event, 'fs54', 131)" class="i">t</span>,<span onmouseout="hideTip(event, 'fs55', 132)" onmouseover="showTip(event, 'fs55', 132)" class="i">os</span>) <span class="k">in</span> <span onmouseout="hideTip(event, 'fs52', 133)" onmouseover="showTip(event, 'fs52', 133)" class="i">consumerOffsets</span> <span class="k">do</span>
  <span class="k">for</span> (<span onmouseout="hideTip(event, 'fs56', 134)" onmouseover="showTip(event, 'fs56', 134)" class="i">p</span>,<span onmouseout="hideTip(event, 'fs57', 135)" onmouseover="showTip(event, 'fs57', 135)" class="i">o</span>) <span class="k">in</span> <span onmouseout="hideTip(event, 'fs55', 136)" onmouseover="showTip(event, 'fs55', 136)" class="i">os</span> <span class="k">do</span>
    <span onmouseout="hideTip(event, 'fs18', 137)" onmouseover="showTip(event, 'fs18', 137)" class="f">printfn</span> <span class="s">&quot;topic=</span><span class="pf">%s</span><span class="s"> partition=</span><span class="pf">%i</span><span class="s"> offset=</span><span class="pf">%i</span><span class="s">&quot;</span> <span onmouseout="hideTip(event, 'fs54', 138)" onmouseover="showTip(event, 'fs54', 138)" class="i">t</span> <span onmouseout="hideTip(event, 'fs56', 139)" onmouseover="showTip(event, 'fs56', 139)" class="i">p</span> <span onmouseout="hideTip(event, 'fs57', 140)" onmouseover="showTip(event, 'fs57', 140)" class="i">o</span>
</code></pre></td>
</tr>
</table>
<h2><a name="Rolling-Updates" class="anchor" href="#Rolling-Updates">Rolling Updates</a></h2>
<p>Kafka supports rolling updates of consumer group member instances. This can be done by having a newever version of
a consumer support both new and old versions of consumer group assignment strategies. The assignment strategy itself can
change, but the code path invoked by the consumer can also change. The Kafka group coordinator ensures that all members
of the group support the same protocol version. Once new versions have been deployed, all consumer instances will support
the new version and Kafka will select the first version in the list.</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
<span class="l">17: </span>
<span class="l">18: </span>
<span class="l">19: </span>
<span class="l">20: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="c">/// This configuration specifies two versions of an assignment strategy.</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs58', 141)" onmouseover="showTip(event, 'fs58', 141)" class="i">consumerConfigVersioned</span> <span class="o">=</span> 
  <span onmouseout="hideTip(event, 'fs9', 142)" onmouseover="showTip(event, 'fs9', 142)" class="t">ConsumerConfig</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs10', 143)" onmouseover="showTip(event, 'fs10', 143)" class="f">create</span> (
    <span class="i">groupId</span> <span class="o">=</span> <span class="s">&quot;consumer-group&quot;</span>, 
    <span class="i">topic</span> <span class="o">=</span> <span class="s">&quot;absurd-topic&quot;</span>,
    <span class="i">assignmentStrategies</span> <span class="o">=</span> [|
        <span class="s">&quot;range/v2&quot;</span>, <span onmouseout="hideTip(event, 'fs59', 144)" onmouseover="showTip(event, 'fs59', 144)" class="t">ConsumerGroup</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs60', 145)" onmouseover="showTip(event, 'fs60', 145)" class="t">AssignmentStratgies</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs61', 146)" onmouseover="showTip(event, 'fs61', 146)" class="i">Range</span>
        <span class="s">&quot;range/v1&quot;</span>, <span onmouseout="hideTip(event, 'fs59', 147)" onmouseover="showTip(event, 'fs59', 147)" class="t">ConsumerGroup</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs60', 148)" onmouseover="showTip(event, 'fs60', 148)" class="t">AssignmentStratgies</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs61', 149)" onmouseover="showTip(event, 'fs61', 149)" class="i">Range</span> |])

<span class="c">/// The handler accepts a consumer group member state object, which contains</span>
<span class="c">/// the selected protocol version. This can be used to invoke different code paths.</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs62', 150)" onmouseover="showTip(event, 'fs62', 150)" class="f">handle</span> (<span onmouseout="hideTip(event, 'fs25', 151)" onmouseover="showTip(event, 'fs25', 151)" class="i">s</span><span class="o">:</span><span onmouseout="hideTip(event, 'fs26', 152)" onmouseover="showTip(event, 'fs26', 152)" class="t">GroupMemberState</span>) (<span onmouseout="hideTip(event, 'fs27', 153)" onmouseover="showTip(event, 'fs27', 153)" class="i">ms</span><span class="o">:</span><span onmouseout="hideTip(event, 'fs28', 154)" onmouseover="showTip(event, 'fs28', 154)" class="t">ConsumerMessageSet</span>) <span class="o">=</span> <span onmouseout="hideTip(event, 'fs29', 155)" onmouseover="showTip(event, 'fs29', 155)" class="i">async</span> {
  <span class="k">match</span> <span onmouseout="hideTip(event, 'fs25', 156)" onmouseover="showTip(event, 'fs25', 156)" class="i">s</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs31', 157)" onmouseover="showTip(event, 'fs31', 157)" class="i">protocolName</span> <span class="k">with</span>
  | <span class="s">&quot;range/v2&quot;</span> <span class="k">-&gt;</span>
    <span onmouseout="hideTip(event, 'fs18', 158)" onmouseover="showTip(event, 'fs18', 158)" class="f">printfn</span> <span class="s">&quot;running version 2&quot;</span>
  
  | <span class="s">&quot;range/v1&quot;</span> <span class="k">-&gt;</span>
    <span onmouseout="hideTip(event, 'fs18', 159)" onmouseover="showTip(event, 'fs18', 159)" class="f">printfn</span> <span class="s">&quot;running version 1&quot;</span>

  | <span onmouseout="hideTip(event, 'fs63', 160)" onmouseover="showTip(event, 'fs63', 160)" class="i">v</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs64', 161)" onmouseover="showTip(event, 'fs64', 161)" class="f">failwithf</span> <span class="s">&quot;unknown protocol_version=</span><span class="pf">%s</span><span class="s">&quot;</span> <span onmouseout="hideTip(event, 'fs63', 162)" onmouseover="showTip(event, 'fs63', 162)" class="i">v</span> }
</code></pre></td>
</tr>
</table>
<h2><a name="Contributing-and-copyright" class="anchor" href="#Contributing-and-copyright">Contributing and copyright</a></h2>
<p>The project is hosted on <a href="https://github.com/jet/kafunk">GitHub</a> where you can <a href="https://github.com/jet/kafunk/issues">report issues</a>, fork
the project and submit pull requests. If you're adding a new public API, please also
consider adding <a href="https://github.com/jet/kafunk/docs/content">samples</a> that can be turned into a documentation. You might
also want to read the <a href="https://github.com/jet/kafunk/project/README.md">library design notes</a> to understand how it works.</p>
<p>The library is available under Apache 2.0. For more information see the
<a href="https://github.com/jet/kafunk/project/LICENSE.txt">License file</a> in the GitHub repository.</p>

<div class="tip" id="fs1">Multiple items<br />namespace FSharp<br /><br />--------------------<br />namespace Microsoft.FSharp</div>
<div class="tip" id="fs2">Multiple items<br />namespace FSharp.Control<br /><br />--------------------<br />namespace Microsoft.FSharp.Control</div>
<div class="tip" id="fs3">namespace Kafunk</div>
<div class="tip" id="fs4">namespace System</div>
<div class="tip" id="fs5">val conn : KafkaConn<br /><br />Full name: Consuming.conn</div>
<div class="tip" id="fs6">module Kafka<br /><br />from Kafunk</div>
<div class="tip" id="fs7">val connHost : host:string -&gt; KafkaConn<br /><br />Full name: Kafunk.Kafka.connHost</div>
<div class="tip" id="fs8">val consumerConfig : ConsumerConfig<br /><br />Full name: Consuming.consumerConfig<br /><em><br /><br />&#160;Configuration.</em></div>
<div class="tip" id="fs9">type ConsumerConfig =<br />&#160;&#160;{groupId: GroupId;<br />&#160;&#160;&#160;topic: TopicName;<br />&#160;&#160;&#160;sessionTimeout: SessionTimeout;<br />&#160;&#160;&#160;rebalanceTimeout: RebalanceTimeout;<br />&#160;&#160;&#160;heartbeatFrequency: int32;<br />&#160;&#160;&#160;fetchMinBytes: MinBytes;<br />&#160;&#160;&#160;fetchMaxWaitMs: MaxWaitTime;<br />&#160;&#160;&#160;fetchMaxBytes: MaxBytes;<br />&#160;&#160;&#160;offsetRetentionTime: RetentionTime;<br />&#160;&#160;&#160;initialFetchTime: Time;<br />&#160;&#160;&#160;...}<br />&#160;&#160;static member create : groupId:GroupId * topic:TopicName * ?initialFetchTime:Time * ?fetchMaxBytes:MaxBytes * ?sessionTimeout:SessionTimeout * ?rebalanceTimeout:RebalanceTimeout * ?heartbeatFrequency:int32 * ?offsetRetentionTime:RetentionTime * ?fetchMinBytes:MinBytes * ?fetchMaxWaitMs:MaxWaitTime * ?endOfTopicPollPolicy:RetryPolicy * ?outOfRangeAction:ConsumerOffsetOutOfRangeAction * ?fetchBufferSize:int * ?assignmentStrategies:(AssignmentStrategyName * AssignmentStrategy) [] -&gt; ConsumerConfig<br /><br />Full name: Kafunk.ConsumerConfig</div>
<div class="tip" id="fs10">static member ConsumerConfig.create : groupId:GroupId * topic:TopicName * ?initialFetchTime:Time * ?fetchMaxBytes:MaxBytes * ?sessionTimeout:SessionTimeout * ?rebalanceTimeout:RebalanceTimeout * ?heartbeatFrequency:int32 * ?offsetRetentionTime:RetentionTime * ?fetchMinBytes:MinBytes * ?fetchMaxWaitMs:MaxWaitTime * ?endOfTopicPollPolicy:RetryPolicy * ?outOfRangeAction:ConsumerOffsetOutOfRangeAction * ?fetchBufferSize:int * ?assignmentStrategies:(AssignmentStrategyName * ConsumerGroup.AssignmentStrategy) [] -&gt; ConsumerConfig</div>
<div class="tip" id="fs11">val consumer : Consumer<br /><br />Full name: Consuming.consumer<br /><em><br /><br />&#160;The name of the consumer group.<br />&#160;The topic to consume.<br />&#160;This creates a consumer and joins it to the group.</em></div>
<div class="tip" id="fs12">Multiple items<br />module Consumer<br /><br />from Kafunk<br /><br />--------------------<br />type Consumer =<br />&#160;&#160;private {conn: KafkaConn;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;config: ConsumerConfig;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;groupMember: GroupMember;}<br /><br />Full name: Kafunk.Consumer</div>
<div class="tip" id="fs13">val create : conn:KafkaConn -&gt; cfg:ConsumerConfig -&gt; Consumer<br /><br />Full name: Kafunk.Consumer.create</div>
<div class="tip" id="fs14">val consumerState : ConsumerState<br /><br />Full name: Consuming.consumerState</div>
<div class="tip" id="fs15">val state : c:Consumer -&gt; Async&lt;ConsumerState&gt;<br /><br />Full name: Kafunk.Consumer.state</div>
<div class="tip" id="fs16">Multiple items<br />module Async<br /><br />from Kafunk<br /><br />--------------------<br />type Async<br />static member AsBeginEnd : computation:(&#39;Arg -&gt; Async&lt;&#39;T&gt;) -&gt; (&#39;Arg * AsyncCallback * obj -&gt; IAsyncResult) * (IAsyncResult -&gt; &#39;T) * (IAsyncResult -&gt; unit)<br />static member AwaitEvent : event:IEvent&lt;&#39;Del,&#39;T&gt; * ?cancelAction:(unit -&gt; unit) -&gt; Async&lt;&#39;T&gt; (requires delegate and &#39;Del :&gt; Delegate)<br />static member AwaitIAsyncResult : iar:IAsyncResult * ?millisecondsTimeout:int -&gt; Async&lt;bool&gt;<br />static member AwaitTask : task:Task -&gt; Async&lt;unit&gt;<br />static member AwaitTask : task:Task&lt;&#39;T&gt; -&gt; Async&lt;&#39;T&gt;<br />static member AwaitWaitHandle : waitHandle:WaitHandle * ?millisecondsTimeout:int -&gt; Async&lt;bool&gt;<br />static member CancelDefaultToken : unit -&gt; unit<br />static member Catch : computation:Async&lt;&#39;T&gt; -&gt; Async&lt;Choice&lt;&#39;T,exn&gt;&gt;<br />static member FromBeginEnd : beginAction:(AsyncCallback * obj -&gt; IAsyncResult) * endAction:(IAsyncResult -&gt; &#39;T) * ?cancelAction:(unit -&gt; unit) -&gt; Async&lt;&#39;T&gt;<br />static member FromBeginEnd : arg:&#39;Arg1 * beginAction:(&#39;Arg1 * AsyncCallback * obj -&gt; IAsyncResult) * endAction:(IAsyncResult -&gt; &#39;T) * ?cancelAction:(unit -&gt; unit) -&gt; Async&lt;&#39;T&gt;<br />static member FromBeginEnd : arg1:&#39;Arg1 * arg2:&#39;Arg2 * beginAction:(&#39;Arg1 * &#39;Arg2 * AsyncCallback * obj -&gt; IAsyncResult) * endAction:(IAsyncResult -&gt; &#39;T) * ?cancelAction:(unit -&gt; unit) -&gt; Async&lt;&#39;T&gt;<br />static member FromBeginEnd : arg1:&#39;Arg1 * arg2:&#39;Arg2 * arg3:&#39;Arg3 * beginAction:(&#39;Arg1 * &#39;Arg2 * &#39;Arg3 * AsyncCallback * obj -&gt; IAsyncResult) * endAction:(IAsyncResult -&gt; &#39;T) * ?cancelAction:(unit -&gt; unit) -&gt; Async&lt;&#39;T&gt;<br />static member FromContinuations : callback:((&#39;T -&gt; unit) * (exn -&gt; unit) * (OperationCanceledException -&gt; unit) -&gt; unit) -&gt; Async&lt;&#39;T&gt;<br />static member Ignore : computation:Async&lt;&#39;T&gt; -&gt; Async&lt;unit&gt;<br />static member OnCancel : interruption:(unit -&gt; unit) -&gt; Async&lt;IDisposable&gt;<br />static member Parallel : computations:seq&lt;Async&lt;&#39;T&gt;&gt; -&gt; Async&lt;&#39;T []&gt;<br />static member RunSynchronously : computation:Async&lt;&#39;T&gt; * ?timeout:int * ?cancellationToken:CancellationToken -&gt; &#39;T<br />static member Sleep : millisecondsDueTime:int -&gt; Async&lt;unit&gt;<br />static member Start : computation:Async&lt;unit&gt; * ?cancellationToken:CancellationToken -&gt; unit<br />static member StartAsTask : computation:Async&lt;&#39;T&gt; * ?taskCreationOptions:TaskCreationOptions * ?cancellationToken:CancellationToken -&gt; Task&lt;&#39;T&gt;<br />static member StartChild : computation:Async&lt;&#39;T&gt; * ?millisecondsTimeout:int -&gt; Async&lt;Async&lt;&#39;T&gt;&gt;<br />static member StartChildAsTask : computation:Async&lt;&#39;T&gt; * ?taskCreationOptions:TaskCreationOptions -&gt; Async&lt;Task&lt;&#39;T&gt;&gt;<br />static member StartImmediate : computation:Async&lt;unit&gt; * ?cancellationToken:CancellationToken -&gt; unit<br />static member StartWithContinuations : computation:Async&lt;&#39;T&gt; * continuation:(&#39;T -&gt; unit) * exceptionContinuation:(exn -&gt; unit) * cancellationContinuation:(OperationCanceledException -&gt; unit) * ?cancellationToken:CancellationToken -&gt; unit<br />static member SwitchToContext : syncContext:SynchronizationContext -&gt; Async&lt;unit&gt;<br />static member SwitchToNewThread : unit -&gt; Async&lt;unit&gt;<br />static member SwitchToThreadPool : unit -&gt; Async&lt;unit&gt;<br />static member TryCancelled : computation:Async&lt;&#39;T&gt; * compensation:(OperationCanceledException -&gt; unit) -&gt; Async&lt;&#39;T&gt;<br />static member CancellationToken : Async&lt;CancellationToken&gt;<br />static member DefaultCancellationToken : CancellationToken<br /><br />Full name: Microsoft.FSharp.Control.Async<br /><br />--------------------<br />type Async&lt;&#39;T&gt;<br /><br />Full name: Microsoft.FSharp.Control.Async&lt;_&gt;</div>
<div class="tip" id="fs17">static member Async.RunSynchronously : computation:Async&lt;&#39;T&gt; * ?timeout:int * ?cancellationToken:Threading.CancellationToken -&gt; &#39;T</div>
<div class="tip" id="fs18">val printfn : format:Printf.TextWriterFormat&lt;&#39;T&gt; -&gt; &#39;T<br /><br />Full name: Microsoft.FSharp.Core.ExtraTopLevelOperators.printfn</div>
<div class="tip" id="fs19">ConsumerState.generationId: GenerationId</div>
<div class="tip" id="fs20">ConsumerState.memberId: MemberId</div>
<div class="tip" id="fs21">ConsumerState.leaderId: LeaderId</div>
<div class="tip" id="fs22">ConsumerState.assignmentStrategy: AssignmentStrategyName</div>
<div class="tip" id="fs23">ConsumerState.assignments: Partition []</div>
<div class="tip" id="fs24">val consume : c:Consumer -&gt; handler:(GroupMemberState -&gt; ConsumerMessageSet -&gt; Async&lt;unit&gt;) -&gt; Async&lt;unit&gt;<br /><br />Full name: Kafunk.Consumer.consume</div>
<div class="tip" id="fs25">val s : GroupMemberState</div>
<div class="tip" id="fs26">type GroupMemberState =<br />&#160;&#160;{generationId: GenerationId;<br />&#160;&#160;&#160;memberId: MemberId;<br />&#160;&#160;&#160;leaderId: LeaderId;<br />&#160;&#160;&#160;members: (MemberId * ProtocolMetadata) [];<br />&#160;&#160;&#160;memberAssignment: MemberAssignment;<br />&#160;&#160;&#160;protocolName: ProtocolName;<br />&#160;&#160;&#160;closed: CancellationToken;}<br /><br />Full name: Kafunk.GroupMemberState</div>
<div class="tip" id="fs27">val ms : ConsumerMessageSet</div>
<div class="tip" id="fs28">Multiple items<br />type ConsumerMessageSet =<br />&#160;&#160;struct<br />&#160;&#160;&#160;&#160;new : t:TopicName * p:Partition * ms:MessageSet * hwmo:HighwaterMarkOffset -&gt; ConsumerMessageSet<br />&#160;&#160;&#160;&#160;val topic: TopicName<br />&#160;&#160;&#160;&#160;val partition: Partition<br />&#160;&#160;&#160;&#160;val messageSet: MessageSet<br />&#160;&#160;&#160;&#160;val highWatermarkOffset: HighwaterMarkOffset<br />&#160;&#160;&#160;&#160;static member commitOffset : ms:ConsumerMessageSet -&gt; Offset<br />&#160;&#160;&#160;&#160;static member commitPartitionOffsets : ms:ConsumerMessageSet -&gt; (Partition * Offset) []<br />&#160;&#160;&#160;&#160;static member firstOffset : ms:ConsumerMessageSet -&gt; Offset<br />&#160;&#160;&#160;&#160;static member lag : ms:ConsumerMessageSet -&gt; HighwaterMarkOffset<br />&#160;&#160;&#160;&#160;static member lastOffset : ms:ConsumerMessageSet -&gt; Offset<br />&#160;&#160;&#160;&#160;...<br />&#160;&#160;end<br /><br />Full name: Kafunk.ConsumerMessageSet<br /><br />--------------------<br />ConsumerMessageSet()<br />new : t:TopicName * p:Partition * ms:MessageSet * hwmo:HighwaterMarkOffset -&gt; ConsumerMessageSet</div>
<div class="tip" id="fs29">val async : AsyncBuilder<br /><br />Full name: Microsoft.FSharp.Core.ExtraTopLevelOperators.async</div>
<div class="tip" id="fs30">GroupMemberState.memberId: MemberId</div>
<div class="tip" id="fs31">GroupMemberState.protocolName: ProtocolName</div>
<div class="tip" id="fs32">ConsumerMessageSet.topic: TopicName</div>
<div class="tip" id="fs33">ConsumerMessageSet.partition: Partition</div>
<div class="tip" id="fs34">val commitOffsets : c:Consumer -&gt; offsets:(Partition * Offset) [] -&gt; Async&lt;unit&gt;<br /><br />Full name: Kafunk.Consumer.commitOffsets</div>
<div class="tip" id="fs35">static member ConsumerMessageSet.commitPartitionOffsets : ms:ConsumerMessageSet -&gt; (Partition * Offset) []</div>
<div class="tip" id="fs36">val consumePeriodicCommit : c:Consumer -&gt; commitInterval:TimeSpan -&gt; handler:(GroupMemberState -&gt; ConsumerMessageSet -&gt; Async&lt;unit&gt;) -&gt; Async&lt;unit&gt;<br /><br />Full name: Kafunk.Consumer.consumePeriodicCommit</div>
<div class="tip" id="fs37">Multiple items<br />type TimeSpan =<br />&#160;&#160;struct<br />&#160;&#160;&#160;&#160;new : ticks:int64 -&gt; TimeSpan + 3 overloads<br />&#160;&#160;&#160;&#160;member Add : ts:TimeSpan -&gt; TimeSpan<br />&#160;&#160;&#160;&#160;member CompareTo : value:obj -&gt; int + 1 overload<br />&#160;&#160;&#160;&#160;member Days : int<br />&#160;&#160;&#160;&#160;member Duration : unit -&gt; TimeSpan<br />&#160;&#160;&#160;&#160;member Equals : value:obj -&gt; bool + 1 overload<br />&#160;&#160;&#160;&#160;member GetHashCode : unit -&gt; int<br />&#160;&#160;&#160;&#160;member Hours : int<br />&#160;&#160;&#160;&#160;member Milliseconds : int<br />&#160;&#160;&#160;&#160;member Minutes : int<br />&#160;&#160;&#160;&#160;...<br />&#160;&#160;end<br /><br />Full name: System.TimeSpan<br /><br />--------------------<br />TimeSpan()<br />TimeSpan(ticks: int64) : unit<br />TimeSpan(hours: int, minutes: int, seconds: int) : unit<br />TimeSpan(days: int, hours: int, minutes: int, seconds: int) : unit<br />TimeSpan(days: int, hours: int, minutes: int, seconds: int, milliseconds: int) : unit</div>
<div class="tip" id="fs38">TimeSpan.FromSeconds(value: float) : TimeSpan</div>
<div class="tip" id="fs39">val commitQueue : Offsets.PeriodicCommitQueue<br /><br />Full name: Consuming.commitQueue<br /><em><br /><br />&#160;Create a commit queue</em></div>
<div class="tip" id="fs40">module Offsets<br /><br />from Kafunk</div>
<div class="tip" id="fs41">val createPeriodicCommitQueue : TimeSpan * ((Partition * Offset) [] -&gt; Async&lt;unit&gt;) -&gt; Offsets.PeriodicCommitQueue<br /><br />Full name: Kafunk.Offsets.createPeriodicCommitQueue</div>
<div class="tip" id="fs42">TimeSpan.FromHours(value: float) : TimeSpan</div>
<div class="tip" id="fs43">val ms : ConsumerMessageSet<br /><br />Full name: Consuming.ms</div>
<div class="tip" id="fs44">val failwith : message:string -&gt; &#39;T<br /><br />Full name: Microsoft.FSharp.Core.Operators.failwith</div>
<div class="tip" id="fs45">val enqueuePeriodicCommit : q:Offsets.PeriodicCommitQueue -&gt; os:seq&lt;Partition * Offset&gt; -&gt; unit<br /><br />Full name: Kafunk.Offsets.enqueuePeriodicCommit</div>
<div class="tip" id="fs46">val stream : c:Consumer -&gt; AsyncSeq&lt;GroupMemberState * ConsumerMessageSet&gt;<br /><br />Full name: Kafunk.Consumer.stream</div>
<div class="tip" id="fs47">Multiple items<br />module AsyncSeq<br /><br />from FSharp.Control<br /><br />--------------------<br />type AsyncSeq&lt;&#39;T&gt; = IAsyncEnumerable&lt;&#39;T&gt;<br /><br />Full name: FSharp.Control.AsyncSeq&lt;_&gt;</div>
<div class="tip" id="fs48">val iterAsync : action:(&#39;T -&gt; Async&lt;unit&gt;) -&gt; source:AsyncSeq&lt;&#39;T&gt; -&gt; Async&lt;unit&gt;<br /><br />Full name: FSharp.Control.AsyncSeq.iterAsync</div>
<div class="tip" id="fs49">val commitOffsetsToTime : c:Consumer -&gt; time:Time -&gt; Async&lt;unit&gt;<br /><br />Full name: Kafunk.Consumer.commitOffsetsToTime</div>
<div class="tip" id="fs50">Multiple items<br />module Time<br /><br />from Kafunk.Protocol<br /><br />--------------------<br />type Time = int64<br /><br />Full name: Kafunk.Protocol.Time</div>
<div class="tip" id="fs51">val EarliestOffset : int64<br /><br />Full name: Kafunk.Protocol.Time.EarliestOffset</div>
<div class="tip" id="fs52">val consumerOffsets : (TopicName * (Partition * Offset) []) []<br /><br />Full name: Consuming.consumerOffsets<br /><em><br /><br />&#160;Asynchronously enqueue offsets to be committed.</em></div>
<div class="tip" id="fs53">val fetchOffsets : conn:KafkaConn -&gt; groupId:GroupId -&gt; topics:(TopicName * Partition []) [] -&gt; Async&lt;(TopicName * (Partition * Offset) []) []&gt;<br /><br />Full name: Kafunk.Consumer.fetchOffsets</div>
<div class="tip" id="fs54">val t : TopicName</div>
<div class="tip" id="fs55">val os : (Partition * Offset) []</div>
<div class="tip" id="fs56">val p : Partition</div>
<div class="tip" id="fs57">val o : Offset</div>
<div class="tip" id="fs58">val consumerConfigVersioned : ConsumerConfig<br /><br />Full name: Consuming.consumerConfigVersioned<br /><em><br /><br />&#160;This configuration specifies two versions of an assignment strategy.</em></div>
<div class="tip" id="fs59">Multiple items<br />module ConsumerGroup<br /><br />from Kafunk<br /><br />--------------------<br />type ConsumerGroup = string<br /><br />Full name: Kafunk.Protocol.ConsumerGroup</div>
<div class="tip" id="fs60">module AssignmentStratgies<br /><br />from Kafunk.ConsumerGroup</div>
<div class="tip" id="fs61">val Range : ConsumerGroup.AssignmentStrategy<br /><br />Full name: Kafunk.ConsumerGroup.AssignmentStratgies.Range</div>
<div class="tip" id="fs62">val handle : s:GroupMemberState -&gt; ms:ConsumerMessageSet -&gt; Async&lt;unit&gt;<br /><br />Full name: Consuming.handle<br /><em><br /><br />&#160;The handler accepts a consumer group member state object, which contains<br />&#160;the selected protocol version. This can be used to invoke different code paths.</em></div>
<div class="tip" id="fs63">val v : ProtocolName</div>
<div class="tip" id="fs64">val failwithf : format:Printf.StringFormat&lt;&#39;T,&#39;Result&gt; -&gt; &#39;T<br /><br />Full name: Microsoft.FSharp.Core.ExtraTopLevelOperators.failwithf</div>

        </div>
        <div class="span3">
          <img src="/kafunk/img/logo.png" alt="F# Project" style="width:150px;margin:10px" />  
          <ul class="nav nav-list" id="menu" style="margin-top: 20px;">
            <li class="nav-header">Kafunk</li>
            <li><a href="/kafunk/index.html">Home page</a></li>
            <li class="divider"></li>
            <li><a href="http://nuget.org/packages/kafunk">Get Library via NuGet</a></li>
            <li><a href="http://github.com/jet/kafunk">Source Code on GitHub</a></li>
            <li><a href="/kafunk/license.html">License</a></li>
            <li><a href="/kafunk/release-notes.html">Release Notes</a></li>
            
            <li class="nav-header">Getting started</li>
            <li><a href="/kafunk/consuming.html">Consuming</a></li>
            <li><a href="/kafunk/producing.html">Producing</a></li>

            <li class="nav-header">Documentation</li>
            <li><a href="/kafunk/reference/index.html">API Reference</a></li>
          </ul>
        </div>
      </div>
    </div>
    <a href="http://github.com/jet/kafunk"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_gray_6d6d6d.png" alt="Fork me on GitHub"/></a>
  </body>
  </html>
